<!DOCTYPE html>
<html lang="es">
<head>
  <base href="." />
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mi Blog</title>
  <script type="module">
    // Importar Firebase
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js";

    // Configuración de Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyCxx1Oy3IVOzYPYggilV5okWyozPnw08QQ",
      authDomain: "web-blog-e36f9.firebaseapp.com",
      databaseURL: "https://web-blog-e36f9-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "web-blog-e36f9",
      storageBucket: "web-blog-e36f9.appspot.com",
      messagingSenderId: "851452791419",
      appId: "1:851452791419:web:6a748bcbad7bfeba4a30de",
      measurementId: "G-F1WXKQPL6S"
    };

    // Inicializar Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Función para guardar un post en Firestore
    async function savePost(title, content) {
      try {
        await addDoc(collection(db, "posts"), {
          title: title,
          content: content,
          date: new Date().toISOString(),
        });
        alert("Post guardado exitosamente.");
        loadPosts(); // Recargar posts después de guardar
      } catch (error) {
        console.error("Error al guardar el post: ", error);
      }
    }

    // Función para cargar posts desde Firestore
    async function loadPosts() {
      const blogGrid = document.getElementById("blogGrid");
      blogGrid.innerHTML = ""; // Limpiar el contenido actual
      try {
        const querySnapshot = await getDocs(collection(db, "posts"));
        querySnapshot.forEach((doc) => {
          const post = doc.data();
          blogGrid.innerHTML += `
            <div class="blog-card">
              <div class="blog-content">
                <h2>${post.title}</h2>
                <p>${post.content}</p>
                <p><small>${new Date(post.date).toLocaleString()}</small></p>
              </div>
            </div>
          `;
        });
      } catch (error) {
        console.error("Error al cargar los posts: ", error);
      }
    }

    // Manejar el envío del formulario
    document.addEventListener("DOMContentLoaded", () => {
      loadPosts(); // Cargar posts al cargar la página
      const postForm = document.getElementById("postForm");
      postForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const title = document.getElementById("title").value;
        const content = document.getElementById("content").value;
        if (title && content) {
          savePost(title, content);
          postForm.reset(); // Limpiar el formulario
        } else {
          alert("Por favor, completa todos los campos.");
        }
      });
    });
  </script>
  <style>
    /* Tu CSS aquí (omitido por espacio) */
  </style>
</head>
<body>
  <header class="header">
    <div class="hamburger">
      <span></span>
      <span></span>
      <span></span>
    </div>
    <button class="login-btn" onclick="logout()">Logout</button>
  </header>

  <nav class="menu">
    <ul>
      <li><a href="#inicio">Inicio</a></li>
      <li><a href="#articulos">Artículos</a></li>
      <li><a href="#categorias">Categorías</a></li>
      <li><a href="#sobre-mi">Sobre Mí</a></li>
      <li><a href="#contacto">Contacto</a></li>
    </ul>
  </nav>

  <div class="main-content">
    <h1>Bienvenidos a mi blog</h1>

    <!-- Formulario para crear posts -->
    <form id="postForm">
      <input type="text" id="title" placeholder="Título del post" required />
      <textarea id="content" placeholder="Contenido del post" required></textarea>
      <button type="submit">Crear Post</button>
    </form>

    <!-- Grid para mostrar los posts -->
    <div class="blog-grid" id="blogGrid"></div>
  </div>
</body>
</html>
